<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AG Clothing - Cart Items</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Reset and Basics */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
    }
    body {
      background-color: #f5f5f5;
      padding: 20px;
      color: #333;
    }
    /* Navbar */
    .navbar {
      background-color: #232f3e;
      color: white;
      display: flex;
      align-items: center;
      padding: 10px 20px;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .logo {
      font-size: 24px;
      font-weight: bold;
    }
    .logo img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
    }
    .search-bar {
      flex: 1;
      margin: 0 20px;
      display: flex;
    }
    .search-bar input {
      width: 100%;
      padding: 8px;
      border: none;
      border-radius: 4px 0 0 4px;
    }
    .search-bar button {
      padding: 8px;
      background-color: #febd69;
      border: none;
      border-radius: 0 4px 4px 0;
      cursor: pointer;
    }
    .cart {
      position: relative;
      cursor: pointer;
    }
    .cart i {
      font-size: 24px;
    }
    .cart-count {
      position: absolute;
      top: -6px;
      right: -10px;
      background: red;
      color: white;
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 50%;
    }
    /* Category Menu */
    .category-menu {
      background-color: #37475a;
      padding: 10px;
      text-align: center;
    }
    .category-menu a {
      color: white;
      margin: 0 12px;
      text-decoration: none;
      font-weight: bold;
    }
    .category-menu a:hover {
      text-decoration: underline;
    }
    /* Cart Container */
    .cart-container {
      max-width: 1000px;
      margin: auto;
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      margin-top: 20px;
    }
    .cart-item {
      display: flex;
      align-items: center;
      padding: 15px;
      border-bottom: 1px solid #ddd;
      margin-bottom: 15px;
    }
    .cart-item img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 6px;
      margin-right: 15px;
    }
    .cart-item-details {
      flex: 1;
    }
    .cart-item-details h3 {
      font-size: 1.2rem;
      margin-bottom: 5px;
    }
    .cart-item-details p {
      margin: 5px 0;
      color: #555;
    }
    .cart-item-details button {
      background: #dc3545;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
    }
    .cart-item-details button:hover {
      background: #c82333;
    }
    .cart-total {
      text-align: right;
      font-size: 1.5rem;
      font-weight: bold;
      margin: 20px 0;
    }
    .location-section {
      margin: 20px 0;
      padding: 15px;
      background: #f1f1f1;
      border-radius: 8px;
    }
    .location-section h3 {
      margin-bottom: 10px;
    }
    .location-options {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }
    .location-options button {
      padding: 10px;
      background: #febd69;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .location-options button i {
      font-size: 16px;
    }
    #map {
      height: 200px;
      width: 100%;
      border-radius: 8px;
      margin-top: 10px;
      display: none;
    }
    .address-input {
      margin-top: 10px;
    }
    .address-input input, .address-input textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 10px;
    }
    .address-input textarea {
      resize: vertical;
    }
    .live-location {
      margin-top: 10px;
      display: none;
    }
    .live-location a {
      color: #007bff;
      text-decoration: none;
      font-weight: bold;
    }
    .live-location a:hover {
      text-decoration: underline;
    }
    .checkout-button {
      display: block;
      width: 100%;
      padding: 15px;
      background: #28a745;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 1.2rem;
      font-weight: bold;
      cursor: pointer;
      text-align: center;
      margin-top: 20px;
    }
    .checkout-button:hover {
      background: #218838;
    }
    .empty-cart {
      text-align: center;
      font-size: 1.2rem;
      color: #888;
      padding: 20px;
    }
    /* Footer */
    .footer {
      background-color: #232f3e;
      color: white;
      text-align: center;
      padding: 20px;
    }
    .footer p {
      margin: 8px 0;
    }
    .footer a {
      color: #febd69;
      text-decoration: none;
    }
    .footer a:hover {
      text-decoration: underline;
    }
    @media (max-width: 768px) {
      .cart-item {
        flex-direction: column;
        text-align: center;
      }
      .cart-item img {
        margin-bottom: 10px;
      }
      .cart-total {
        text-align: center;
      }
      .location-options {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="logo">
      <a href="index.html">
        <img src="ag-logo.jpg" alt="AG Logo">
      </a>
    </div>

    <div class="search-bar">
      <input type="text" id="search-input" placeholder="Search for products...">
      <button id="search-button"><i class="fas fa-search"></i></button>
    </div>
    <div class="cart" id="cart-icon">
      <i class="fas fa-shopping-cart"></i>
      <div class="cart-count" id="cart-count">0</div>
    </div>
  </nav>
  <div class="category-menu">
    <a href="index.html">Home</a>
    <a href="clothes.html">Clothes</a>
    <a href="gift-items.html">Gift Items</a>
    <a href="mobiles.html">Mobiles</a>
    <a href="laptops.html">Laptops</a>
    <a href="fashion.html">Fashion</a>
    <a href="mens-wear.html">Men's Wear</a>
    <a href="womens-wear.html">Women's Wear</a>
    <a href="kids-wear.html">Kids' Wear</a>
    <a href="fridges.html">Fridges</a>
    <a href="tvs.html">TVs</a>
    <a href="watches.html">Watches</a>
    <a href="cart.html">Cart Items</a>
    <a href="deliverable.html">Delivered Items</a>
    <a href="contact.html">Contact & Support</a>
  </div>
  <div class="cart-container">
    <h2>Cart Items</h2>
    <div id="cart-items"></div>
    <div id="empty-cart" class="empty-cart" style="display: none;">Your cart is empty.</div>
    <div class="cart-total" id="cart-total">Total: â‚¹0</div>
    <div class="location-section">
      <h3>Delivery Information</h3>
      <div class="address-input">
        <input type="text" id="customer-name" placeholder="Enter your name...">
        <input type="tel" id="customer-mobile" placeholder="Enter your mobile number..." pattern="[0-9]{10}">
      </div>
      <div class="location-options">
        <button id="get-location"><i class="fas fa-map-marker-alt"></i> Use Current Location</button>
        <span>or</span>
        <button id="share-live-location"><i class="fas fa-share"></i> Share Live Location</button>
        <span>or</span>
        <button id="manual-address-btn">Enter Address Manually</button>
      </div>
      <div id="map"></div>
      <div class="live-location" id="live-location">
        <p>Your live location: <a id="live-location-link" href="#" target="_blank">View on Google Maps</a></p>
      </div>
      <div class="address-input" id="address-input" style="display: none;">
        <textarea id="manual-address" placeholder="Enter your delivery address..." rows="4"></textarea>
      </div>
    </div>
    <button class="checkout-button" id="checkout-button">Proceed to Checkout via WhatsApp</button>
  </div>
  <footer class="footer">
    <p><i class="fas fa-phone"></i> +91 9876543210</p>
    <p><i class="fas fa-envelope"></i> support@agclothing.com</p>
    <p><i class="fab fa-instagram"></i> <a href="https://instagram.com" target="_blank">@agclothing</a></p>
  </footer>
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&callback=initMap" async defer></script>
  <script>
    function getCart() {
      return JSON.parse(localStorage.getItem('cart') || '[]');
    }
    function saveCart(cart) {
      localStorage.setItem('cart', JSON.stringify(cart));
    }
    function getDeliveredItems() {
      return JSON.parse(localStorage.getItem('deliveredItems') || '[]');
    }
    function saveDeliveredItems(items) {
      localStorage.setItem('deliveredItems', JSON.stringify(items));
    }
    function updateCartCount() {
      const cart = getCart();
      document.getElementById('cart-count').textContent = cart.length;
    }
    function handleSearch() {
      const query = document.getElementById('search-input').value.trim();
      if (query) {
        window.location.href = `index.html?search=${encodeURIComponent(query)}`;
      }
    }
    function loadCart() {
      const cart = getCart();
      const cartItemsContainer = document.getElementById('cart-items');
      const emptyCart = document.getElementById('empty-cart');
      const checkoutButton = document.getElementById('checkout-button');
      cartItemsContainer.innerHTML = '';
      let total = 0;
      if (cart.length === 0) {
        emptyCart.style.display = 'block';
        checkoutButton.style.display = 'none';
      } else {
        emptyCart.style.display = 'none';
        checkoutButton.style.display = 'block';
        cart.forEach((item, index) => {
          const price = parseFloat(item.price.replace('â‚¹', '')) || 0;
          total += price * (item.quantity || 1);
          const div = document.createElement('div');
          div.className = 'cart-item';
          div.innerHTML = `
            <img src="${item.imgSrc}" alt="${item.name}"/>
            <div class="cart-item-details">
              <h3>${item.name}</h3>
              <p>Price: ${item.price}</p>
              <p>Size: ${item.size}</p>
              <p>Quantity: ${item.quantity}</p>
              <button onclick="removeFromCart(${index})">Remove</button>
            </div>
          `;
          cartItemsContainer.appendChild(div);
        });
      }
      document.getElementById('cart-total').textContent = `Total: â‚¹${total.toFixed(2)}`;
    }
    function removeFromCart(index) {
      const cart = getCart();
      cart.splice(index, 1);
      saveCart(cart);
      loadCart();
      updateCartCount();
    }
    function initMap(lat = 20.5937, lng = 78.9629) {
      map = new google.maps.Map(document.getElementById('map'), {
        center: { lat, lng },
        zoom: 12
      });
      marker = new google.maps.Marker({
        position: { lat, lng },
        map: map
      });
    }
    let userLocation = null;
    document.getElementById('get-location').addEventListener('click', () => {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (position) => {
            userLocation = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };
            map.setCenter(userLocation);
            marker.setPosition(userLocation);
            document.getElementById('map').style.display = 'block';
            document.getElementById('address-input').style.display = 'none';
            document.getElementById('live-location').style.display = 'none';
            document.getElementById('manual-address').value = '';
          },
          (error) => {
            alert('Unable to retrieve location. Please allow location access or enter address manually.');
            console.error(error);
          }
        );
      } else {
        alert('Geolocation is not supported by this browser.');
      }
    });
    document.getElementById('share-live-location').addEventListener('click', () => {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (position) => {
            userLocation = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };
            const googleMapsLink = `https://www.google.com/maps?q=${userLocation.lat},${userLocation.lng}`;
            document.getElementById('live-location-link').href = googleMapsLink;
            document.getElementById('live-location-link').textContent = `View on Google Maps (${userLocation.lat}, ${userLocation.lng})`;
            document.getElementById('live-location').style.display = 'block';
            document.getElementById('map').style.display = 'none';
            document.getElementById('address-input').style.display = 'none';
            document.getElementById('manual-address').value = '';
          },
          (error) => {
            alert('Unable to retrieve location. Please allow location access or enter address manually.');
            console.error(error);
          }
        );
      } else {
        alert('Geolocation is not supported by this browser.');
      }
    });
    document.getElementById('manual-address-btn').addEventListener('click', () => {
      document.getElementById('address-input').style.display = 'block';
      document.getElementById('map').style.display = 'none';
      document.getElementById('live-location').style.display = 'none';
      userLocation = null;
    });
    document.getElementById('search-button').addEventListener('click', handleSearch);
    document.getElementById('search-input').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        handleSearch();
      }
    });
    document.getElementById('cart-icon').addEventListener('click', () => {
      window.location.href = 'cart.html';
    });
    document.getElementById('checkout-button').addEventListener('click', () => {
      const cart = getCart();
      if (cart.length === 0) {
        alert('Your cart is empty!');
        return;
      }
      const name = document.getElementById('customer-name').value.trim();
      const mobile = document.getElementById('customer-mobile').value.trim();
      if (!name || !mobile) {
        alert('Please provide your name and mobile number.');
        return;
      }
      if (!/^[0-9]{10}$/.test(mobile)) {
        alert('Please enter a valid 10-digit mobile number.');
        return;
      }
      let message = `New Order:\n\nCustomer Name: ${name}\nMobile Number: ${mobile}\n\nItems:\n`;
      let total = 0;
      cart.forEach(item => {
        const price = parseFloat(item.price.replace('â‚¹', '')) || 0;
        total += price * (item.quantity || 1);
        message += `\nItem: ${item.name}\nPrice: ${item.price}\nSize: ${item.size}\nQuantity: ${item.quantity}\nImage: ${item.imgSrc}\n`;
      });
      message += `\nTotal: â‚¹${total.toFixed(2)}\n\n`;
      if (userLocation) {
        const googleMapsLink = `https://www.google.com/maps?q=${userLocation.lat},${userLocation.lng}`;
        message += `Delivery Location: ${googleMapsLink}`;
      } else {
        const address = document.getElementById('manual-address').value.trim();
        if (!address) {
          alert('Please provide a delivery address, share your live location, or use your current location.');
          return;
        }
        message += `Delivery Address: ${address}`;
      }
      const deliveredItems = getDeliveredItems();
      const now = Date.now();
      cart.forEach(item => {
        item.orderTimestamp = now;
        item.status = 'On the Way';
        deliveredItems.push(item);
      });
      saveDeliveredItems(deliveredItems);
      saveCart([]);
      loadCart();
      updateCartCount();
      const whatsappNumber = '+919398355147'; // Replace with your WhatsApp number
      const encodedMessage = encodeURIComponent(message);
      const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
      window.open(whatsappUrl, '_blank');
      alert('WhatsApp chat opened with your order details and image URLs. Click the links to view images, or manually attach item images in WhatsApp if needed. Please click "Send" to submit the order.');
      setTimeout(() => {
        window.location.href = 'deliverable.html';
      }, 1000);
    });
    window.onload = () => {
      initMap();
      loadCart();
      updateCartCount();
    };
  </script>
</body>
</html>